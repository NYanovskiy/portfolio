{"ast":null,"code":"// Storage keys\nexport const STORAGE = {\n  TASKS: 'productivity_tracker_tasks',\n  HABITS: 'productivity_tracker_habits',\n  POMODOROS: 'productivity_tracker_pomodoros',\n  THEME: 'productivity_tracker_theme',\n  BG: 'productivity_tracker_bg'\n};\n\n// Load data from localStorage\nexport const load = (key, defaultValue = null) => {\n  try {\n    const item = localStorage.getItem(key);\n\n    // Handle background images differently (they're stored as raw data URLs)\n    if (key === STORAGE.BG) {\n      return item || defaultValue;\n    }\n\n    // Parse JSON for other data\n    return item ? JSON.parse(item) : defaultValue;\n  } catch (error) {\n    console.error('Error loading from localStorage:', error);\n    return defaultValue;\n  }\n};\n\n// Save data to localStorage\nexport const save = (key, value) => {\n  try {\n    // Handle background images differently (store as raw data URL)\n    if (key === STORAGE.BG) {\n      if (value && value.trim() !== '') {\n        // Validate data URL format\n        if (!value.startsWith('data:image/')) {\n          throw new Error('Invalid image data format');\n        }\n\n        // Check approximate size (Base64 encoding adds ~33% overhead)\n        const approximateSize = value.length * 0.75;\n        const maxSize = 8 * 1024 * 1024; // 8MB as a safety limit for localStorage\n\n        if (approximateSize > maxSize) {\n          throw new Error('Image too large for storage');\n        }\n        localStorage.setItem(key, value);\n      } else {\n        localStorage.removeItem(key);\n      }\n      return;\n    }\n\n    // JSON stringify for other data\n    localStorage.setItem(key, JSON.stringify(value));\n  } catch (error) {\n    console.error('Error saving to localStorage:', error);\n\n    // If it's a quota exceeded error, try to provide helpful feedback\n    if (error.name === 'QuotaExceededError' || error.message.includes('quota')) {\n      throw new Error('Storage quota exceeded. Try uploading a smaller image.');\n    }\n    if (error.message.includes('Invalid image') || error.message.includes('too large')) {\n      throw error;\n    }\n    throw error;\n  }\n};\n\n// Clear all app data\nexport const clearAll = () => {\n  Object.values(STORAGE).forEach(key => {\n    localStorage.removeItem(key);\n  });\n};","map":{"version":3,"names":["STORAGE","TASKS","HABITS","POMODOROS","THEME","BG","load","key","defaultValue","item","localStorage","getItem","JSON","parse","error","console","save","value","trim","startsWith","Error","approximateSize","length","maxSize","setItem","removeItem","stringify","name","message","includes","clearAll","Object","values","forEach"],"sources":["C:/Users/Никита/Desktop/cur/src/utils/storage.js"],"sourcesContent":["// Storage keys\nexport const STORAGE = {\n  TASKS: 'productivity_tracker_tasks',\n  HABITS: 'productivity_tracker_habits',\n  POMODOROS: 'productivity_tracker_pomodoros',\n  THEME: 'productivity_tracker_theme',\n  BG: 'productivity_tracker_bg'\n};\n\n// Load data from localStorage\nexport const load = (key, defaultValue = null) => {\n  try {\n    const item = localStorage.getItem(key);\n    \n    // Handle background images differently (they're stored as raw data URLs)\n    if (key === STORAGE.BG) {\n      return item || defaultValue;\n    }\n    \n    // Parse JSON for other data\n    return item ? JSON.parse(item) : defaultValue;\n  } catch (error) {\n    console.error('Error loading from localStorage:', error);\n    return defaultValue;\n  }\n};\n\n// Save data to localStorage\nexport const save = (key, value) => {\n  try {\n    // Handle background images differently (store as raw data URL)\n    if (key === STORAGE.BG) {\n      if (value && value.trim() !== '') {\n        // Validate data URL format\n        if (!value.startsWith('data:image/')) {\n          throw new Error('Invalid image data format');\n        }\n        \n        // Check approximate size (Base64 encoding adds ~33% overhead)\n        const approximateSize = value.length * 0.75;\n        const maxSize = 8 * 1024 * 1024; // 8MB as a safety limit for localStorage\n        \n        if (approximateSize > maxSize) {\n          throw new Error('Image too large for storage');\n        }\n        \n        localStorage.setItem(key, value);\n      } else {\n        localStorage.removeItem(key);\n      }\n      return;\n    }\n    \n    // JSON stringify for other data\n    localStorage.setItem(key, JSON.stringify(value));\n  } catch (error) {\n    console.error('Error saving to localStorage:', error);\n    \n    // If it's a quota exceeded error, try to provide helpful feedback\n    if (error.name === 'QuotaExceededError' || error.message.includes('quota')) {\n      throw new Error('Storage quota exceeded. Try uploading a smaller image.');\n    }\n    \n    if (error.message.includes('Invalid image') || error.message.includes('too large')) {\n      throw error;\n    }\n    \n    throw error;\n  }\n};\n\n// Clear all app data\nexport const clearAll = () => {\n  Object.values(STORAGE).forEach(key => {\n    localStorage.removeItem(key);\n  });\n};\n"],"mappings":"AAAA;AACA,OAAO,MAAMA,OAAO,GAAG;EACrBC,KAAK,EAAE,4BAA4B;EACnCC,MAAM,EAAE,6BAA6B;EACrCC,SAAS,EAAE,gCAAgC;EAC3CC,KAAK,EAAE,4BAA4B;EACnCC,EAAE,EAAE;AACN,CAAC;;AAED;AACA,OAAO,MAAMC,IAAI,GAAGA,CAACC,GAAG,EAAEC,YAAY,GAAG,IAAI,KAAK;EAChD,IAAI;IACF,MAAMC,IAAI,GAAGC,YAAY,CAACC,OAAO,CAACJ,GAAG,CAAC;;IAEtC;IACA,IAAIA,GAAG,KAAKP,OAAO,CAACK,EAAE,EAAE;MACtB,OAAOI,IAAI,IAAID,YAAY;IAC7B;;IAEA;IACA,OAAOC,IAAI,GAAGG,IAAI,CAACC,KAAK,CAACJ,IAAI,CAAC,GAAGD,YAAY;EAC/C,CAAC,CAAC,OAAOM,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;IACxD,OAAON,YAAY;EACrB;AACF,CAAC;;AAED;AACA,OAAO,MAAMQ,IAAI,GAAGA,CAACT,GAAG,EAAEU,KAAK,KAAK;EAClC,IAAI;IACF;IACA,IAAIV,GAAG,KAAKP,OAAO,CAACK,EAAE,EAAE;MACtB,IAAIY,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;QAChC;QACA,IAAI,CAACD,KAAK,CAACE,UAAU,CAAC,aAAa,CAAC,EAAE;UACpC,MAAM,IAAIC,KAAK,CAAC,2BAA2B,CAAC;QAC9C;;QAEA;QACA,MAAMC,eAAe,GAAGJ,KAAK,CAACK,MAAM,GAAG,IAAI;QAC3C,MAAMC,OAAO,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;;QAEjC,IAAIF,eAAe,GAAGE,OAAO,EAAE;UAC7B,MAAM,IAAIH,KAAK,CAAC,6BAA6B,CAAC;QAChD;QAEAV,YAAY,CAACc,OAAO,CAACjB,GAAG,EAAEU,KAAK,CAAC;MAClC,CAAC,MAAM;QACLP,YAAY,CAACe,UAAU,CAAClB,GAAG,CAAC;MAC9B;MACA;IACF;;IAEA;IACAG,YAAY,CAACc,OAAO,CAACjB,GAAG,EAAEK,IAAI,CAACc,SAAS,CAACT,KAAK,CAAC,CAAC;EAClD,CAAC,CAAC,OAAOH,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;;IAErD;IACA,IAAIA,KAAK,CAACa,IAAI,KAAK,oBAAoB,IAAIb,KAAK,CAACc,OAAO,CAACC,QAAQ,CAAC,OAAO,CAAC,EAAE;MAC1E,MAAM,IAAIT,KAAK,CAAC,wDAAwD,CAAC;IAC3E;IAEA,IAAIN,KAAK,CAACc,OAAO,CAACC,QAAQ,CAAC,eAAe,CAAC,IAAIf,KAAK,CAACc,OAAO,CAACC,QAAQ,CAAC,WAAW,CAAC,EAAE;MAClF,MAAMf,KAAK;IACb;IAEA,MAAMA,KAAK;EACb;AACF,CAAC;;AAED;AACA,OAAO,MAAMgB,QAAQ,GAAGA,CAAA,KAAM;EAC5BC,MAAM,CAACC,MAAM,CAAChC,OAAO,CAAC,CAACiC,OAAO,CAAC1B,GAAG,IAAI;IACpCG,YAAY,CAACe,UAAU,CAAClB,GAAG,CAAC;EAC9B,CAAC,CAAC;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}