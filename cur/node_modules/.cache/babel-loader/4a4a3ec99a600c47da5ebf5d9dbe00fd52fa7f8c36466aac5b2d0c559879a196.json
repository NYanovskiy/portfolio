{"ast":null,"code":"// Storage keys\nexport const STORAGE={TASKS:'productivity_tracker_tasks',HABITS:'productivity_tracker_habits',POMODOROS:'productivity_tracker_pomodoros',THEME:'productivity_tracker_theme',BG:'productivity_tracker_bg'};// Load data from localStorage\nexport const load=function(key){let defaultValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;try{const item=localStorage.getItem(key);// Handle background images differently (they're stored as raw data URLs)\nif(key===STORAGE.BG){return item||defaultValue;}// Parse JSON for other data\nreturn item?JSON.parse(item):defaultValue;}catch(error){console.error('Error loading from localStorage:',error);return defaultValue;}};// Save data to localStorage\nexport const save=(key,value)=>{try{// Handle background images differently (store as raw data URL)\nif(key===STORAGE.BG){if(value&&value.trim()!==''){// Validate data URL format\nif(!value.startsWith('data:image/')){throw new Error('Invalid image data format');}// Check approximate size (Base64 encoding adds ~33% overhead)\nconst approximateSize=value.length*0.75;const maxSize=8*1024*1024;// 8MB as a safety limit for localStorage\nif(approximateSize>maxSize){throw new Error('Image too large for storage');}localStorage.setItem(key,value);}else{localStorage.removeItem(key);}return;}// JSON stringify for other data\nlocalStorage.setItem(key,JSON.stringify(value));}catch(error){console.error('Error saving to localStorage:',error);// If it's a quota exceeded error, try to provide helpful feedback\nif(error.name==='QuotaExceededError'||error.message.includes('quota')){throw new Error('Storage quota exceeded. Try uploading a smaller image.');}if(error.message.includes('Invalid image')||error.message.includes('too large')){throw error;}throw error;}};// Clear all app data\nexport const clearAll=()=>{Object.values(STORAGE).forEach(key=>{localStorage.removeItem(key);});};","map":{"version":3,"names":["STORAGE","TASKS","HABITS","POMODOROS","THEME","BG","load","key","defaultValue","arguments","length","undefined","item","localStorage","getItem","JSON","parse","error","console","save","value","trim","startsWith","Error","approximateSize","maxSize","setItem","removeItem","stringify","name","message","includes","clearAll","Object","values","forEach"],"sources":["C:/Users/Никита/Desktop/GALL/p2/cur/src/utils/storage.js"],"sourcesContent":["// Storage keys\nexport const STORAGE = {\n  TASKS: 'productivity_tracker_tasks',\n  HABITS: 'productivity_tracker_habits',\n  POMODOROS: 'productivity_tracker_pomodoros',\n  THEME: 'productivity_tracker_theme',\n  BG: 'productivity_tracker_bg'\n};\n\n// Load data from localStorage\nexport const load = (key, defaultValue = null) => {\n  try {\n    const item = localStorage.getItem(key);\n    \n    // Handle background images differently (they're stored as raw data URLs)\n    if (key === STORAGE.BG) {\n      return item || defaultValue;\n    }\n    \n    // Parse JSON for other data\n    return item ? JSON.parse(item) : defaultValue;\n  } catch (error) {\n    console.error('Error loading from localStorage:', error);\n    return defaultValue;\n  }\n};\n\n// Save data to localStorage\nexport const save = (key, value) => {\n  try {\n    // Handle background images differently (store as raw data URL)\n    if (key === STORAGE.BG) {\n      if (value && value.trim() !== '') {\n        // Validate data URL format\n        if (!value.startsWith('data:image/')) {\n          throw new Error('Invalid image data format');\n        }\n        \n        // Check approximate size (Base64 encoding adds ~33% overhead)\n        const approximateSize = value.length * 0.75;\n        const maxSize = 8 * 1024 * 1024; // 8MB as a safety limit for localStorage\n        \n        if (approximateSize > maxSize) {\n          throw new Error('Image too large for storage');\n        }\n        \n        localStorage.setItem(key, value);\n      } else {\n        localStorage.removeItem(key);\n      }\n      return;\n    }\n    \n    // JSON stringify for other data\n    localStorage.setItem(key, JSON.stringify(value));\n  } catch (error) {\n    console.error('Error saving to localStorage:', error);\n    \n    // If it's a quota exceeded error, try to provide helpful feedback\n    if (error.name === 'QuotaExceededError' || error.message.includes('quota')) {\n      throw new Error('Storage quota exceeded. Try uploading a smaller image.');\n    }\n    \n    if (error.message.includes('Invalid image') || error.message.includes('too large')) {\n      throw error;\n    }\n    \n    throw error;\n  }\n};\n\n// Clear all app data\nexport const clearAll = () => {\n  Object.values(STORAGE).forEach(key => {\n    localStorage.removeItem(key);\n  });\n};\n"],"mappings":"AAAA;AACA,MAAO,MAAM,CAAAA,OAAO,CAAG,CACrBC,KAAK,CAAE,4BAA4B,CACnCC,MAAM,CAAE,6BAA6B,CACrCC,SAAS,CAAE,gCAAgC,CAC3CC,KAAK,CAAE,4BAA4B,CACnCC,EAAE,CAAE,yBACN,CAAC,CAED;AACA,MAAO,MAAM,CAAAC,IAAI,CAAG,QAAAA,CAACC,GAAG,CAA0B,IAAxB,CAAAC,YAAY,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,CAC3C,GAAI,CACF,KAAM,CAAAG,IAAI,CAAGC,YAAY,CAACC,OAAO,CAACP,GAAG,CAAC,CAEtC;AACA,GAAIA,GAAG,GAAKP,OAAO,CAACK,EAAE,CAAE,CACtB,MAAO,CAAAO,IAAI,EAAIJ,YAAY,CAC7B,CAEA;AACA,MAAO,CAAAI,IAAI,CAAGG,IAAI,CAACC,KAAK,CAACJ,IAAI,CAAC,CAAGJ,YAAY,CAC/C,CAAE,MAAOS,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxD,MAAO,CAAAT,YAAY,CACrB,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAW,IAAI,CAAGA,CAACZ,GAAG,CAAEa,KAAK,GAAK,CAClC,GAAI,CACF;AACA,GAAIb,GAAG,GAAKP,OAAO,CAACK,EAAE,CAAE,CACtB,GAAIe,KAAK,EAAIA,KAAK,CAACC,IAAI,CAAC,CAAC,GAAK,EAAE,CAAE,CAChC;AACA,GAAI,CAACD,KAAK,CAACE,UAAU,CAAC,aAAa,CAAC,CAAE,CACpC,KAAM,IAAI,CAAAC,KAAK,CAAC,2BAA2B,CAAC,CAC9C,CAEA;AACA,KAAM,CAAAC,eAAe,CAAGJ,KAAK,CAACV,MAAM,CAAG,IAAI,CAC3C,KAAM,CAAAe,OAAO,CAAG,CAAC,CAAG,IAAI,CAAG,IAAI,CAAE;AAEjC,GAAID,eAAe,CAAGC,OAAO,CAAE,CAC7B,KAAM,IAAI,CAAAF,KAAK,CAAC,6BAA6B,CAAC,CAChD,CAEAV,YAAY,CAACa,OAAO,CAACnB,GAAG,CAAEa,KAAK,CAAC,CAClC,CAAC,IAAM,CACLP,YAAY,CAACc,UAAU,CAACpB,GAAG,CAAC,CAC9B,CACA,OACF,CAEA;AACAM,YAAY,CAACa,OAAO,CAACnB,GAAG,CAAEQ,IAAI,CAACa,SAAS,CAACR,KAAK,CAAC,CAAC,CAClD,CAAE,MAAOH,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,CAAEA,KAAK,CAAC,CAErD;AACA,GAAIA,KAAK,CAACY,IAAI,GAAK,oBAAoB,EAAIZ,KAAK,CAACa,OAAO,CAACC,QAAQ,CAAC,OAAO,CAAC,CAAE,CAC1E,KAAM,IAAI,CAAAR,KAAK,CAAC,wDAAwD,CAAC,CAC3E,CAEA,GAAIN,KAAK,CAACa,OAAO,CAACC,QAAQ,CAAC,eAAe,CAAC,EAAId,KAAK,CAACa,OAAO,CAACC,QAAQ,CAAC,WAAW,CAAC,CAAE,CAClF,KAAM,CAAAd,KAAK,CACb,CAEA,KAAM,CAAAA,KAAK,CACb,CACF,CAAC,CAED;AACA,MAAO,MAAM,CAAAe,QAAQ,CAAGA,CAAA,GAAM,CAC5BC,MAAM,CAACC,MAAM,CAAClC,OAAO,CAAC,CAACmC,OAAO,CAAC5B,GAAG,EAAI,CACpCM,YAAY,CAACc,UAAU,CAACpB,GAAG,CAAC,CAC9B,CAAC,CAAC,CACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}